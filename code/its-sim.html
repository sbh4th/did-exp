<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ITS treatment considerations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="its-sim_files/libs/clipboard/clipboard.min.js"></script>
<script src="its-sim_files/libs/quarto-html/quarto.js"></script>
<script src="its-sim_files/libs/quarto-html/popper.min.js"></script>
<script src="its-sim_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="its-sim_files/libs/quarto-html/anchor.min.js"></script>
<link href="its-sim_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="its-sim_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="its-sim_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="its-sim_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="its-sim_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ITS treatment considerations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-setup" class="level2">
<h2 class="anchored" data-anchor-id="data-setup">Data setup</h2>
<p>First let’s simulate some data. Although this is an ITS analysis that usually would have two time series, I’ve simulated a bunch of units for each treatment group to generate some sampling error. We’ll simulate 1000 observations from 30 different groups (e.g., states) over a period of 20 years, but in this case every single group is treated (i.e., there are no ‘never treated’ units.). There are two treatment cohorts that are treated at different times, one in 2010 and the other in 2015. The 2015 cohort is twice as large as the 2010 cohort, just to include some variation. Each group has both a different underlying secular trend and a different treatment effect.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytable)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">95478</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># unit fixed effects (unobserved heterogeneity)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>unit <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate clusters</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit_fe =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, state<span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate instantaneous treatment effect</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mu = rnorm(nobs, true_mu, 0.2)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> <span class="dv">2</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># year fixed effects (first part)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2001</span><span class="sc">:</span><span class="dv">2020</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">year_fe =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(year), <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the clusters into treatment groups</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>treat_taus <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample the clusters randomly</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># place the randomly sampled states into 1\{t \ge g \}G_g</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort_year =</span> <span class="fu">sort</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2010</span>, <span class="dv">2015</span>), <span class="at">times=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>)))</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># make main dataset</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># full interaction of unit X year </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>dtest <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">unit =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">year =</span> <span class="dv">2001</span><span class="sc">:</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., unit) <span class="sc">%&gt;%</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., year) <span class="sc">%&gt;%</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., treat_taus) <span class="sc">%&gt;%</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make error term and get treatment indicators and treatment effects</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also get cohort specific trends (modify time FE)</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span><span class="sc">*</span><span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">ifelse</span>((year <span class="sc">&gt;=</span> </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>           cohort_year), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>         <span class="co"># treatment effect = 4 if 2015, 1 if 2010, annually</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">mu =</span> <span class="fu">ifelse</span>(cohort_year<span class="sc">==</span><span class="dv">2015</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">tau =</span> <span class="fu">ifelse</span>(treat <span class="sc">==</span> <span class="dv">1</span>, mu, <span class="dv">0</span>),</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>         <span class="co"># year trends differ by cohort</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">year_fe =</span> year_fe <span class="sc">+</span> (<span class="dv">2020</span> <span class="sc">-</span> cohort_year) <span class="sc">*</span> </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>           (year <span class="sc">-</span> cohort_year) <span class="sc">/</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate cumulative treatment effects</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(unit) <span class="sc">%&gt;%</span> </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tau_cum =</span> <span class="fu">cumsum</span>(tau)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the dependent variable</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> (<span class="dv">2020</span> <span class="sc">-</span> cohort_year) <span class="sc">+</span> </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>           unit_fe <span class="sc">+</span> year_fe <span class="sc">+</span> tau_cum <span class="sc">+</span> error) </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Relabel 2018 cohort as never-treated</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(cohort_year = ifelse(cohort_year == 2018, Inf, cohort_year))</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># bring in simulated DiD dataset</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> dtest <span class="sc">%&gt;%</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># read_rds(here("data", </span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a> <span class="co">#"did-sim-data.rds")) %&gt;%</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year0 =</span> year <span class="sc">-</span> <span class="dv">2001</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">yearc =</span> year <span class="sc">-</span> cohort_year,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">since =</span> treat <span class="sc">*</span> yearc,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort_2015 =</span> <span class="fu">ifelse</span>(cohort_year <span class="sc">==</span> <span class="dv">2015</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is a plot of the simulated data, with the averages plotted for each cohort and the time of intervention marked on the graph. The specific treatment effects are 1 for the 2010 cohort and 4 for the 2015 cohort.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="its-sim_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="group-specific-analysis" class="level2">
<h2 class="anchored" data-anchor-id="group-specific-analysis">Group-specific analysis</h2>
<p>What is the causal effect of the intervention in the 2010 cohort?</p>
<p>Let’s do the ITS for the early treated cohort with a simple model like:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p><span class="math display">\[Y_{it} = \beta_{0} + \beta_{1}*year0 + \beta_{2}*treat + \beta_{3}*since + \epsilon_{it}\]</span></p>
<p>First, let’s estimate the models separately for each cohort. We’ll use the <code>lm_robust</code> function from <code>estimatr</code> to easily get cluster robust standard errors.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># models</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>m_c2010 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(y <span class="sc">~</span> year0 <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, cohort_year <span class="sc">==</span> <span class="dv">2010</span>), </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>m_c2015 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(y <span class="sc">~</span> year0 <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, cohort_year <span class="sc">==</span> <span class="dv">2015</span>), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"2010 cohort"</span> <span class="ot">=</span> m_c2010,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"2015 cohort"</span> <span class="ot">=</span> m_c2015),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">statistic =</span> <span class="st">"conf.int"</span>, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> term <span class="sc">~</span> model <span class="sc">+</span> statistic,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_k0yhndygj4davumro80h(i, j, css_id) {
        var table = document.getElementById("tinytable_k0yhndygj4davumro80h");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_k0yhndygj4davumro80h');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_k0yhndygj4davumro80h(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_k0yhndygj4davumro80h");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 0, 'tinytable_css_idbm94qvsdkluxlqj1muw1') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 1, 'tinytable_css_idab1bs9huvmffv01s8sxj') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 2, 'tinytable_css_idab1bs9huvmffv01s8sxj') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 3, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 4, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 5, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(0, 6, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 0, 'tinytable_css_id58keowhpq1zbwt5pbv08') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 1, 'tinytable_css_idkfunu0hsdx9xxfmod04c') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 2, 'tinytable_css_idkfunu0hsdx9xxfmod04c') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 3, 'tinytable_css_idkfunu0hsdx9xxfmod04c') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 4, 'tinytable_css_idkfunu0hsdx9xxfmod04c') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 5, 'tinytable_css_idkfunu0hsdx9xxfmod04c') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(1, 6, 'tinytable_css_idkfunu0hsdx9xxfmod04c') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 0, 'tinytable_css_idpru7gar8gm68yl1zcnm4') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 1, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 2, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 3, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 4, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 5, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(2, 6, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 0, 'tinytable_css_idpru7gar8gm68yl1zcnm4') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 1, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 2, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 3, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 4, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 5, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(3, 6, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 0, 'tinytable_css_idpru7gar8gm68yl1zcnm4') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 1, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 2, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 3, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 4, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 5, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(4, 6, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 0, 'tinytable_css_idae02e8ggumy7d590gks0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 1, 'tinytable_css_idl4g6zcisoxb165zvq3d0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 2, 'tinytable_css_idl4g6zcisoxb165zvq3d0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 3, 'tinytable_css_idl4g6zcisoxb165zvq3d0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 4, 'tinytable_css_idl4g6zcisoxb165zvq3d0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 5, 'tinytable_css_idl4g6zcisoxb165zvq3d0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(5, 6, 'tinytable_css_idl4g6zcisoxb165zvq3d0') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 0, 'tinytable_css_idpru7gar8gm68yl1zcnm4') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 1, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 2, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 3, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 4, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 5, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(6, 6, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 0, 'tinytable_css_idpru7gar8gm68yl1zcnm4') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 1, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 2, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 3, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 4, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 5, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
window.addEventListener('load', function () { styleCell_k0yhndygj4davumro80h(7, 6, 'tinytable_css_id57hasl5tv4x4fcmjh1a7') })
    </script>

    <style>
    .table td.tinytable_css_idbm94qvsdkluxlqj1muw1, .table th.tinytable_css_idbm94qvsdkluxlqj1muw1 {  text-align: center;  text-align: left; }
    .table td.tinytable_css_idab1bs9huvmffv01s8sxj, .table th.tinytable_css_idab1bs9huvmffv01s8sxj {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_id57hasl5tv4x4fcmjh1a7, .table th.tinytable_css_id57hasl5tv4x4fcmjh1a7 {  text-align: center; }
    .table td.tinytable_css_id58keowhpq1zbwt5pbv08, .table th.tinytable_css_id58keowhpq1zbwt5pbv08 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idkfunu0hsdx9xxfmod04c, .table th.tinytable_css_idkfunu0hsdx9xxfmod04c {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idpru7gar8gm68yl1zcnm4, .table th.tinytable_css_idpru7gar8gm68yl1zcnm4 {  text-align: left; }
    .table td.tinytable_css_idae02e8ggumy7d590gks0, .table th.tinytable_css_idae02e8ggumy7d590gks0 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idl4g6zcisoxb165zvq3d0, .table th.tinytable_css_idl4g6zcisoxb165zvq3d0 {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_k0yhndygj4davumro80h" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">2010 cohort</th>
<th scope="col" align="center" colspan="3">2015 cohort</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>13.49    </td>
                  <td>12.95</td>
                  <td>14.04</td>
                  <td>12.60    </td>
                  <td>12.18</td>
                  <td>13.01</td>
                </tr>
                <tr>
                  <td>year0      </td>
                  <td>1.96     </td>
                  <td>1.94 </td>
                  <td>1.99 </td>
                  <td>1.01     </td>
                  <td>0.99 </td>
                  <td>1.02 </td>
                </tr>
                <tr>
                  <td>treat      </td>
                  <td>1.42     </td>
                  <td>1.23 </td>
                  <td>1.60 </td>
                  <td>4.14     </td>
                  <td>4.01 </td>
                  <td>4.26 </td>
                </tr>
                <tr>
                  <td>since      </td>
                  <td>1.04     </td>
                  <td>1.01 </td>
                  <td>1.08 </td>
                  <td>4.00     </td>
                  <td>3.96 </td>
                  <td>4.04 </td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>6480     </td>
                  <td>     </td>
                  <td>     </td>
                  <td>13520    </td>
                  <td>     </td>
                  <td>     </td>
                </tr>
                <tr>
                  <td>Std.Errors </td>
                  <td>by: state</td>
                  <td>     </td>
                  <td>     </td>
                  <td>by: state</td>
                  <td>     </td>
                  <td>     </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>The slope estimates are basically what we specified (with sampling error) in the simulation (1 for the 2010 cohort and 4 for the 2015 cohort). Now let’s estimate the effect of the intervention at the end of follow-up, setting <code>year0=19</code> and estimating the difference by treatment status, using the <code>marginaleffects</code> package. We’ll estimate the average predictions under each treatment regime and then calculate the difference.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for 2010 cohort</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p_2010 <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m_c2010, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">year0 =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">19</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">since =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))) </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>d_2010 <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(p_2010, <span class="st">"b4 - b1 = 0"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>p_2010 <span class="ot">&lt;-</span> p_2010 <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rowid<span class="sc">==</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(d_2010) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"Untreated"</span>, <span class="st">"Treated"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Difference"</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for 2015 cohort</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>p_2015 <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m_c2015, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">year0 =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">19</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">since =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>d_2015 <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(p_2015, <span class="st">"b4 - b1 = 0"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>p_2015 <span class="ot">&lt;-</span> p_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(rowid<span class="sc">==</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(d_2015) <span class="sc">%&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"Untreated"</span>, <span class="st">"Treated"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Difference"</span>))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"2010 cohort"</span> <span class="ot">=</span> p_2010,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2015 cohort"</span> <span class="ot">=</span> p_2015), <span class="at">fmt=</span><span class="dv">2</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="st">"conf.int"</span>, <span class="at">shape =</span> term <span class="sc">~</span> statistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_kbtf8rbs5km5tvajb6yh(i, j, css_id) {
        var table = document.getElementById("tinytable_kbtf8rbs5km5tvajb6yh");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_kbtf8rbs5km5tvajb6yh');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_kbtf8rbs5km5tvajb6yh(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_kbtf8rbs5km5tvajb6yh");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 0, 'tinytable_css_idvfumspnluyrc9k5inqme') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 1, 'tinytable_css_id397hfq3he6mafutq48p8') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 2, 'tinytable_css_id397hfq3he6mafutq48p8') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 3, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 4, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 5, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(0, 6, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 0, 'tinytable_css_id3znxxr65fe60i7l4foi1') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 1, 'tinytable_css_idros9l6zjs6pmnlc1jfrq') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 2, 'tinytable_css_idros9l6zjs6pmnlc1jfrq') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 3, 'tinytable_css_idros9l6zjs6pmnlc1jfrq') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 4, 'tinytable_css_idros9l6zjs6pmnlc1jfrq') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 5, 'tinytable_css_idros9l6zjs6pmnlc1jfrq') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(1, 6, 'tinytable_css_idros9l6zjs6pmnlc1jfrq') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 0, 'tinytable_css_ido5o0rso4d0tpa9oypn73') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 1, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 2, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 3, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 4, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 5, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(2, 6, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 0, 'tinytable_css_ido5o0rso4d0tpa9oypn73') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 1, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 2, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 3, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 4, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 5, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(3, 6, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 0, 'tinytable_css_ido5o0rso4d0tpa9oypn73') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 1, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 2, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 3, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 4, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 5, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
window.addEventListener('load', function () { styleCell_kbtf8rbs5km5tvajb6yh(4, 6, 'tinytable_css_id0us8vxzt1u1id5l0qeqe') })
    </script>

    <style>
    .table td.tinytable_css_idvfumspnluyrc9k5inqme, .table th.tinytable_css_idvfumspnluyrc9k5inqme {  text-align: center;  text-align: left; }
    .table td.tinytable_css_id397hfq3he6mafutq48p8, .table th.tinytable_css_id397hfq3he6mafutq48p8 {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_id0us8vxzt1u1id5l0qeqe, .table th.tinytable_css_id0us8vxzt1u1id5l0qeqe {  text-align: center; }
    .table td.tinytable_css_id3znxxr65fe60i7l4foi1, .table th.tinytable_css_id3znxxr65fe60i7l4foi1 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idros9l6zjs6pmnlc1jfrq, .table th.tinytable_css_idros9l6zjs6pmnlc1jfrq {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_ido5o0rso4d0tpa9oypn73, .table th.tinytable_css_ido5o0rso4d0tpa9oypn73 {  text-align: left; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_kbtf8rbs5km5tvajb6yh" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">2010 cohort</th>
<th scope="col" align="center" colspan="3">2015 cohort</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Untreated </td>
                  <td>50.81</td>
                  <td>50.26</td>
                  <td>51.36</td>
                  <td>31.71</td>
                  <td>31.23</td>
                  <td>32.20</td>
                </tr>
                <tr>
                  <td>Treated   </td>
                  <td>62.66</td>
                  <td>62.18</td>
                  <td>63.14</td>
                  <td>55.86</td>
                  <td>55.43</td>
                  <td>56.28</td>
                </tr>
                <tr>
                  <td>Difference</td>
                  <td>11.85</td>
                  <td>11.49</td>
                  <td>12.21</td>
                  <td>24.14</td>
                  <td>23.95</td>
                  <td>24.33</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>So, we get predictions of 62.7 under treatment and 50.8 in the counterfactual absence of treatment for the 2010 cohort. The difference is 11.8. For the 2015 later-treated cohort, at the end of follow-up we get predictions of 55.9 under treatment and 31.7 in the counterfactual absence of treatment. The difference is 24.1. If we wanted to ignore any heterogeneity and just calculate an average causal effect at the end of follow-up, we can just take a weighted average of the cohort-specific effects.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>te <span class="ot">&lt;-</span> p_2010<span class="sc">$</span>estimate[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span> p_2015<span class="sc">$</span>estimate[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The average causal effect in the population is 19.08.</p>
<p>In each of these cases it is clear that we are comparing each treated unit to itself to generate these counterfactual estimates. We could also use <code>marginaleffects</code> to get the average annual slopes (though redundant since these are coefficients in the models). Although we fit these models separately, we could hand calculate an overall averaged effect (ignoring cohort heterogeneity). The 2015 cohort is twice as large as the 2010 cohort, so a weighted average of the average treatment slopes above is (1/3) * 1.04 + (2/3) * 4, which is about 3.02.</p>
</section>
<section id="pooled-analysis-with-calendar-time" class="level2">
<h2 class="anchored" data-anchor-id="pooled-analysis-with-calendar-time">Pooled analysis with calendar time</h2>
<p>Now let’s analyze the entire cohort pooled together. Including a fixed effect for cohort in these models will only allow for an overall level shift, and if we include a product term between cohort and time, and cohort and the level change (<code>treat</code>) and cohort and the slope change <code>since</code>), we can recover the causal effects in both cohorts, or averaged over the entire period. Here are all of the model estimates:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m_all <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(<span class="at">formula =</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> year0 <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds, <span class="at">clusters =</span> state)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>m_all_s <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(<span class="at">formula =</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">+</span> year0 <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds, <span class="at">clusters =</span> state)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>m_all_int <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(<span class="at">formula =</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">*</span> (year0 <span class="sc">+</span> treat <span class="sc">+</span> since), </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds, <span class="at">clusters =</span> state)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"2010 cohort"</span> <span class="ot">=</span> m_c2010,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2015 cohort"</span> <span class="ot">=</span> m_c2015, <span class="st">"No cohort FE"</span> <span class="ot">=</span> m_all,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cohort FE"</span> <span class="ot">=</span> m_all_s, <span class="st">"Interactive"</span> <span class="ot">=</span> m_all_int),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_6uro2ur2bkaj7w5mxur7(i, j, css_id) {
        var table = document.getElementById("tinytable_6uro2ur2bkaj7w5mxur7");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_6uro2ur2bkaj7w5mxur7');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_6uro2ur2bkaj7w5mxur7(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_6uro2ur2bkaj7w5mxur7");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(0, 0, 'tinytable_css_id7w6hf1dgdtnwap2c6nyi') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(0, 1, 'tinytable_css_idwdzik7unqghheyctuhp2') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(0, 2, 'tinytable_css_idwdzik7unqghheyctuhp2') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(0, 3, 'tinytable_css_idwdzik7unqghheyctuhp2') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(0, 4, 'tinytable_css_idwdzik7unqghheyctuhp2') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(0, 5, 'tinytable_css_idwdzik7unqghheyctuhp2') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(1, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(1, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(1, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(1, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(1, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(1, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(2, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(2, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(2, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(2, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(2, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(2, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(3, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(3, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(3, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(3, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(3, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(3, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(4, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(4, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(4, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(4, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(4, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(4, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(5, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(5, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(5, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(5, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(5, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(5, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(6, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(6, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(6, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(6, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(6, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(6, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(7, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(7, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(7, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(7, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(7, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(7, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(8, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(8, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(8, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(8, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(8, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(8, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(9, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(9, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(9, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(9, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(9, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(9, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(10, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(10, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(10, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(10, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(10, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(10, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(11, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(11, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(11, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(11, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(11, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(11, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(12, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(12, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(12, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(12, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(12, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(12, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(13, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(13, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(13, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(13, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(13, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(13, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(14, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(14, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(14, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(14, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(14, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(14, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(15, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(15, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(15, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(15, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(15, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(15, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(16, 0, 'tinytable_css_id1hk5yxs32rvogh2fjw8f') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(16, 1, 'tinytable_css_idzgbz9hdetpzimpd8lwsw') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(16, 2, 'tinytable_css_idzgbz9hdetpzimpd8lwsw') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(16, 3, 'tinytable_css_idzgbz9hdetpzimpd8lwsw') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(16, 4, 'tinytable_css_idzgbz9hdetpzimpd8lwsw') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(16, 5, 'tinytable_css_idzgbz9hdetpzimpd8lwsw') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(17, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(17, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(17, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(17, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(17, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(17, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(18, 0, 'tinytable_css_id2wyroklgyfczudv5vuhc') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(18, 1, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(18, 2, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(18, 3, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(18, 4, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
window.addEventListener('load', function () { styleCell_6uro2ur2bkaj7w5mxur7(18, 5, 'tinytable_css_idpdojfn5v95fwaw3jwjgp') })
    </script>

    <style>
    .table td.tinytable_css_id7w6hf1dgdtnwap2c6nyi, .table th.tinytable_css_id7w6hf1dgdtnwap2c6nyi {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idwdzik7unqghheyctuhp2, .table th.tinytable_css_idwdzik7unqghheyctuhp2 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id2wyroklgyfczudv5vuhc, .table th.tinytable_css_id2wyroklgyfczudv5vuhc {  text-align: left; }
    .table td.tinytable_css_idpdojfn5v95fwaw3jwjgp, .table th.tinytable_css_idpdojfn5v95fwaw3jwjgp {  text-align: center; }
    .table td.tinytable_css_id1hk5yxs32rvogh2fjw8f, .table th.tinytable_css_id1hk5yxs32rvogh2fjw8f {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idzgbz9hdetpzimpd8lwsw, .table th.tinytable_css_idzgbz9hdetpzimpd8lwsw {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_6uro2ur2bkaj7w5mxur7" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">2010 cohort</th>
                <th scope="col">2015 cohort</th>
                <th scope="col">No cohort FE</th>
                <th scope="col">Cohort FE</th>
                <th scope="col">Interactive</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)        </td>
                  <td>13.49    </td>
                  <td>12.60    </td>
                  <td>14.02    </td>
                  <td>15.53    </td>
                  <td>13.49    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.28)   </td>
                  <td>(0.21)   </td>
                  <td>(0.44)   </td>
                  <td>(0.29)   </td>
                  <td>(0.28)   </td>
                </tr>
                <tr>
                  <td>year0              </td>
                  <td>1.96     </td>
                  <td>1.01     </td>
                  <td>0.95     </td>
                  <td>1.16     </td>
                  <td>1.96     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                  <td>(0.03)   </td>
                  <td>(0.04)   </td>
                  <td>(0.01)   </td>
                </tr>
                <tr>
                  <td>treat              </td>
                  <td>1.42     </td>
                  <td>4.14     </td>
                  <td>7.26     </td>
                  <td>5.96     </td>
                  <td>1.42     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.10)   </td>
                  <td>(0.07)   </td>
                  <td>(0.28)   </td>
                  <td>(0.19)   </td>
                  <td>(0.10)   </td>
                </tr>
                <tr>
                  <td>since              </td>
                  <td>1.04     </td>
                  <td>4.00     </td>
                  <td>2.58     </td>
                  <td>2.16     </td>
                  <td>1.04     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.02)   </td>
                  <td>(0.02)   </td>
                  <td>(0.12)   </td>
                  <td>(0.16)   </td>
                  <td>(0.02)   </td>
                </tr>
                <tr>
                  <td>cohort_2015        </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>-3.59    </td>
                  <td>-0.90    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.50)   </td>
                  <td>(0.35)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × year0</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>-0.96    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.01)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × treat</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.72     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.12)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × since</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.96     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.03)   </td>
                </tr>
                <tr>
                  <td>Num.Obs.           </td>
                  <td>6480     </td>
                  <td>13520    </td>
                  <td>20000    </td>
                  <td>20000    </td>
                  <td>20000    </td>
                </tr>
                <tr>
                  <td>Std.Errors         </td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>If we use the interacted model we can recover the cohort-specific treatment effects at the end of follow-up above (again, setting <code>year0</code> to 19), as well as getting an overall average (again, choosing to ignore heterogeneity).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions at end of follow-up by treatment</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set up dataframe for predictions</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>eof <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort_2015 =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year0 =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">19</span>,<span class="dv">4</span>)),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">since =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>m_all_int_ap <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m_all_int, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> eof)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># treatment effects</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>m_all_int_te <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(m_all_int_ap, </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"b2 - b1 = 0"</span>, <span class="st">"b4 - b3 = 0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"2010 cohort"</span>, <span class="st">"2015 cohort"</span>))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"Marginal effects from interaction model"</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> m_all_int_te), <span class="at">fmt=</span><span class="dv">2</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="st">"conf.int"</span>, <span class="at">shape =</span> term <span class="sc">~</span> statistic,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="st">"Note: calculated at end of follow-up."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_s64hqsutqgbo4tta5ejx(i, j, css_id) {
        var table = document.getElementById("tinytable_s64hqsutqgbo4tta5ejx");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_s64hqsutqgbo4tta5ejx');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_s64hqsutqgbo4tta5ejx(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_s64hqsutqgbo4tta5ejx");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(0, 0, 'tinytable_css_idfynga4x14i2r4kl1lzws') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(0, 1, 'tinytable_css_idqp6rzfdv9we8e1nrawnj') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(0, 2, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(0, 3, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(1, 0, 'tinytable_css_idt67cmkm0wxd8shb88693') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(1, 1, 'tinytable_css_idwkgh1eapdvww1rtpoqo2') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(1, 2, 'tinytable_css_idwkgh1eapdvww1rtpoqo2') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(1, 3, 'tinytable_css_idwkgh1eapdvww1rtpoqo2') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(2, 0, 'tinytable_css_idpimeb1xfqtp0h75z2nas') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(2, 1, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(2, 2, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(2, 3, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(3, 0, 'tinytable_css_idpimeb1xfqtp0h75z2nas') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(3, 1, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(3, 2, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(3, 3, 'tinytable_css_id4w4pohmgqbvrn5q977i0') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(4, 0, 'tinytable_css_idpimeb1xfqtp0h75z2nas') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(4, 1, 'tinytable_css_idpimeb1xfqtp0h75z2nas') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(4, 2, 'tinytable_css_idpimeb1xfqtp0h75z2nas') })
window.addEventListener('load', function () { styleCell_s64hqsutqgbo4tta5ejx(4, 3, 'tinytable_css_idpimeb1xfqtp0h75z2nas') })
    </script>

    <style>
    .table td.tinytable_css_idfynga4x14i2r4kl1lzws, .table th.tinytable_css_idfynga4x14i2r4kl1lzws {  text-align: center;  text-align: left; }
    .table td.tinytable_css_idqp6rzfdv9we8e1nrawnj, .table th.tinytable_css_idqp6rzfdv9we8e1nrawnj {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_id4w4pohmgqbvrn5q977i0, .table th.tinytable_css_id4w4pohmgqbvrn5q977i0 {  text-align: center; }
    .table td.tinytable_css_idt67cmkm0wxd8shb88693, .table th.tinytable_css_idt67cmkm0wxd8shb88693 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idwkgh1eapdvww1rtpoqo2, .table th.tinytable_css_idwkgh1eapdvww1rtpoqo2 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idpimeb1xfqtp0h75z2nas, .table th.tinytable_css_idpimeb1xfqtp0h75z2nas {  text-align: left; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_s64hqsutqgbo4tta5ejx" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">Marginal effects from interaction model</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="4">Note: calculated at end of follow-up.</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>2010 cohort</td>
                  <td>11.85</td>
                  <td>11.49</td>
                  <td>12.21</td>
                </tr>
                <tr>
                  <td>2015 cohort</td>
                  <td>24.14</td>
                  <td>23.95</td>
                  <td>24.33</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Same estimates that we calculated in the separate models above. The average slopes for each cohort can be estimated from the coefficients in the interacted model above. Since <code>cohort_2015</code>=0 for the 2010 cohort, the term <code>treat</code> gives the level shift at the time of the intervention for the 2010 cohort and the <code>since</code> term gives the post-intervention slope for the 2010 cohort. The product terms between <code>cohort_2015</code> and each of these terms give the <em>difference</em> between cohorts in the level shift and post-intervention slopes, respectively. You can get the cohort-specific slopes from this single model using the <code>avg_slopes</code> function from <code>marginaleffects</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>m_all_int_slopes <span class="ot">&lt;-</span> <span class="fu">avg_slopes</span>(m_all_int, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable=</span><span class="fu">c</span>(<span class="st">"treat"</span>,<span class="st">"since"</span>), </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="st">"cohort_2015"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">"Post-slope (since)"</span>,<span class="st">"Post-slope (since)"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Level shift (treat)"</span>,<span class="st">"Level shift (treat)"</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort_2015 =</span> <span class="fu">factor</span>(cohort_2015,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"2010 cohort"</span>,<span class="st">"2015 cohort"</span>)))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"Average slopes: Interaction model"</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                  <span class="ot">=</span> m_all_int_slopes),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">statistic =</span> <span class="st">"conf.int"</span>, </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> term <span class="sc">~</span> cohort_2015 <span class="sc">+</span> statistic,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_m0v8eshel9cxvgk1i0uv(i, j, css_id) {
        var table = document.getElementById("tinytable_m0v8eshel9cxvgk1i0uv");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_m0v8eshel9cxvgk1i0uv');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_m0v8eshel9cxvgk1i0uv(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_m0v8eshel9cxvgk1i0uv");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 0, 'tinytable_css_id2qe9cmq20iaxg6e5icdg') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 1, 'tinytable_css_idu9c1siarkvlyjhgti5z6') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 2, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 3, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 4, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 5, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(0, 6, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 0, 'tinytable_css_id2qe9cmq20iaxg6e5icdg') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 1, 'tinytable_css_idu9c1siarkvlyjhgti5z6') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 2, 'tinytable_css_idu9c1siarkvlyjhgti5z6') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 3, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 4, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 5, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(1, 6, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 0, 'tinytable_css_idow355s7txnkpxs7xj2n8') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 1, 'tinytable_css_id8mvq48542rtcfj1kgx9s') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 2, 'tinytable_css_id8mvq48542rtcfj1kgx9s') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 3, 'tinytable_css_id8mvq48542rtcfj1kgx9s') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 4, 'tinytable_css_id8mvq48542rtcfj1kgx9s') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 5, 'tinytable_css_id8mvq48542rtcfj1kgx9s') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(2, 6, 'tinytable_css_id8mvq48542rtcfj1kgx9s') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 0, 'tinytable_css_idgp54o3xj483k5e0tilc4') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 1, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 2, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 3, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 4, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 5, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(3, 6, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 0, 'tinytable_css_idgp54o3xj483k5e0tilc4') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 1, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 2, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 3, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 4, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 5, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
window.addEventListener('load', function () { styleCell_m0v8eshel9cxvgk1i0uv(4, 6, 'tinytable_css_idkr7tjxu7xsrp7ag9fj00') })
    </script>

    <style>
    .table td.tinytable_css_id2qe9cmq20iaxg6e5icdg, .table th.tinytable_css_id2qe9cmq20iaxg6e5icdg {  text-align: center;  text-align: left; }
    .table td.tinytable_css_idu9c1siarkvlyjhgti5z6, .table th.tinytable_css_idu9c1siarkvlyjhgti5z6 {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_idkr7tjxu7xsrp7ag9fj00, .table th.tinytable_css_idkr7tjxu7xsrp7ag9fj00 {  text-align: center; }
    .table td.tinytable_css_idow355s7txnkpxs7xj2n8, .table th.tinytable_css_idow355s7txnkpxs7xj2n8 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id8mvq48542rtcfj1kgx9s, .table th.tinytable_css_id8mvq48542rtcfj1kgx9s {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idgp54o3xj483k5e0tilc4, .table th.tinytable_css_idgp54o3xj483k5e0tilc4 {  text-align: left; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_m0v8eshel9cxvgk1i0uv" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="6">Average slopes: Interaction model</th>
</tr>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">2010 cohort</th>
<th scope="col" align="center" colspan="3">2015 cohort</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Post-slope (since) </td>
                  <td>1.04</td>
                  <td>1.01</td>
                  <td>1.08</td>
                  <td>4.00</td>
                  <td>3.96</td>
                  <td>4.04</td>
                </tr>
                <tr>
                  <td>Level shift (treat)</td>
                  <td>1.42</td>
                  <td>1.23</td>
                  <td>1.60</td>
                  <td>4.14</td>
                  <td>4.01</td>
                  <td>4.26</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Again, same as above.</p>
<p>As noted, since the 2015 cohort is twice as large as the 2010 cohort, if we wanted an overall effect the weighted average effect can be derived by setting the value of <code>cohort_2015</code> to (2/3). Of course this average effect is a combination of the counterfactual effects at 10 years post-intervention for the 2010 cohort and 5 years post-intervention for the 2015 cohort.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions at end of follow-up</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># averaging over the entire sample</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>m_all_int_aap <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(m_all_int_ap, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"(1/3)*b1 + (2/3)*b3 = 0"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(1/3)*b2 + (2/3)*b4 = 0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"Untreated"</span>, <span class="st">"Treated"</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>m_all_int_ate <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(m_all_int_ap, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(1/3)*(b2 - b1) + (2/3)*(b4 - b3) = 0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Difference"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>m_all_int_ates <span class="ot">&lt;-</span> m_all_int_aap <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(m_all_int_ate)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"Population average effect: interaction model"</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> m_all_int_ates),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">statistic =</span> <span class="st">"conf.int"</span>, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> term <span class="sc">~</span> model <span class="sc">+</span> statistic,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="st">"Note: cohort fixed effect set to 2/3."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_7rknc2oh8ybwatmp6iu8(i, j, css_id) {
        var table = document.getElementById("tinytable_7rknc2oh8ybwatmp6iu8");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_7rknc2oh8ybwatmp6iu8');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_7rknc2oh8ybwatmp6iu8(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_7rknc2oh8ybwatmp6iu8");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(0, 0, 'tinytable_css_id48pkv2422lff9q5ysk71') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(0, 1, 'tinytable_css_idj9k12ffu88oapo461ie0') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(0, 2, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(0, 3, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(1, 0, 'tinytable_css_idzyt92rrekcb5fiqog15t') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(1, 1, 'tinytable_css_ide3wbm9wy3in5gyt286wt') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(1, 2, 'tinytable_css_ide3wbm9wy3in5gyt286wt') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(1, 3, 'tinytable_css_ide3wbm9wy3in5gyt286wt') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(2, 0, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(2, 1, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(2, 2, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(2, 3, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(3, 0, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(3, 1, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(3, 2, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(3, 3, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(4, 0, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(4, 1, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(4, 2, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(4, 3, 'tinytable_css_idmzt5303vwcpp8g9dvcet') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(5, 0, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(5, 1, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(5, 2, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
window.addEventListener('load', function () { styleCell_7rknc2oh8ybwatmp6iu8(5, 3, 'tinytable_css_id87m4xvqn1w3qu0005hz4') })
    </script>

    <style>
    .table td.tinytable_css_id48pkv2422lff9q5ysk71, .table th.tinytable_css_id48pkv2422lff9q5ysk71 {  text-align: center;  text-align: left; }
    .table td.tinytable_css_idj9k12ffu88oapo461ie0, .table th.tinytable_css_idj9k12ffu88oapo461ie0 {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_idmzt5303vwcpp8g9dvcet, .table th.tinytable_css_idmzt5303vwcpp8g9dvcet {  text-align: center; }
    .table td.tinytable_css_idzyt92rrekcb5fiqog15t, .table th.tinytable_css_idzyt92rrekcb5fiqog15t {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_ide3wbm9wy3in5gyt286wt, .table th.tinytable_css_ide3wbm9wy3in5gyt286wt {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id87m4xvqn1w3qu0005hz4, .table th.tinytable_css_id87m4xvqn1w3qu0005hz4 {  text-align: left; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_7rknc2oh8ybwatmp6iu8" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">Population average effect: interaction model</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="4">Note: cohort fixed effect set to 2/3.</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>Untreated </td>
                  <td>38.08</td>
                  <td>37.71</td>
                  <td>38.45</td>
                </tr>
                <tr>
                  <td>Treated   </td>
                  <td>58.13</td>
                  <td>57.80</td>
                  <td>58.45</td>
                </tr>
                <tr>
                  <td>Difference</td>
                  <td>20.04</td>
                  <td>19.87</td>
                  <td>20.22</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Pretty much the same average predictions and treatment effects as we calculated above.</p>
<p>Now what about the treatment effects for the other models? If we ignore cohort all together the treatment effect at the intervention point is 7.26, and the post-intervention slope is 2.58, which are considerably off from our population weighted values. Since the model that includes a cohort fixed effect only allows for an intercept difference, the estimates from this model aren’t much better. In addition, these models guarantee a positivity violation, since there is zero probability that the 2015 cohort can be treated before 2015 or that the 2010 cohort can be untreated after 2010.</p>
</section>
<section id="relative-time" class="level2">
<h2 class="anchored" data-anchor-id="relative-time">Relative time</h2>
<p>Now let’s work with relative time. First, let’s plot the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yearc, <span class="at">y =</span> y, <span class="at">group =</span> unit)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cohort_year, yearc) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">y =</span> <span class="fu">mean</span>(y)),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">aes</span>(<span class="at">x =</span> yearc, <span class="at">y =</span> y, <span class="at">group =</span> <span class="fu">factor</span>(cohort_year),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">factor</span>(cohort_year)), <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ds <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(yearc) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">y =</span> <span class="fu">mean</span>(y)),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> yearc, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">"#4daf4a"</span>, <span class="at">group=</span><span class="st">"All"</span>), </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Y"</span>,  <span class="at">color =</span> <span class="st">"Treatment group   "</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">'#984ea3'</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">'Set1'</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"2010"</span>, <span class="st">"2015"</span>, <span class="st">"Average"</span>)) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="its-sim_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Yeah, this looks a little strange, and you can see that, of course, the average slope in the early period is only coming from the 2015 cohort, and the slope in the later post period is only coming from the 2010 cohort.</p>
<p>Now let’s estimate the same models as we did above:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>m_c2010_c <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, cohort_2015<span class="sc">==</span><span class="dv">0</span>), </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>m_c2015_c <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, cohort_2015<span class="sc">==</span><span class="dv">1</span>), </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>m_all_c <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds, <span class="at">clusters =</span> state)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>m_all_s_c <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">+</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds, <span class="at">clusters =</span> state)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>m_all_int_c <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">*</span> (yearc <span class="sc">+</span> treat <span class="sc">+</span> since), </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds, <span class="at">clusters =</span> state)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"2010 cohort"</span> <span class="ot">=</span> m_c2010_c,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2015 cohort"</span> <span class="ot">=</span> m_c2015_c, <span class="st">"No cohort FE"</span> <span class="ot">=</span> m_all_c,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cohort FE"</span> <span class="ot">=</span> m_all_s_c, <span class="st">"Interactive"</span> <span class="ot">=</span> m_all_int_c),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_0hx9w03zyepfcsfa0qbj(i, j, css_id) {
        var table = document.getElementById("tinytable_0hx9w03zyepfcsfa0qbj");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_0hx9w03zyepfcsfa0qbj');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_0hx9w03zyepfcsfa0qbj(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_0hx9w03zyepfcsfa0qbj");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(0, 0, 'tinytable_css_idtp94u943sexjcymiea7c') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(0, 1, 'tinytable_css_idvf2seixg50ifx5mcfcda') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(0, 2, 'tinytable_css_idvf2seixg50ifx5mcfcda') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(0, 3, 'tinytable_css_idvf2seixg50ifx5mcfcda') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(0, 4, 'tinytable_css_idvf2seixg50ifx5mcfcda') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(0, 5, 'tinytable_css_idvf2seixg50ifx5mcfcda') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(1, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(1, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(1, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(1, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(1, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(1, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(2, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(2, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(2, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(2, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(2, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(2, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(3, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(3, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(3, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(3, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(3, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(3, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(4, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(4, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(4, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(4, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(4, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(4, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(5, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(5, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(5, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(5, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(5, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(5, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(6, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(6, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(6, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(6, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(6, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(6, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(7, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(7, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(7, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(7, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(7, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(7, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(8, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(8, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(8, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(8, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(8, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(8, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(9, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(9, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(9, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(9, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(9, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(9, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(10, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(10, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(10, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(10, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(10, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(10, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(11, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(11, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(11, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(11, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(11, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(11, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(12, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(12, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(12, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(12, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(12, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(12, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(13, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(13, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(13, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(13, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(13, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(13, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(14, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(14, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(14, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(14, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(14, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(14, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(15, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(15, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(15, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(15, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(15, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(15, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(16, 0, 'tinytable_css_idbotk2t708w6r3k6af6tw') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(16, 1, 'tinytable_css_idspsc23murum4ydahbui2') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(16, 2, 'tinytable_css_idspsc23murum4ydahbui2') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(16, 3, 'tinytable_css_idspsc23murum4ydahbui2') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(16, 4, 'tinytable_css_idspsc23murum4ydahbui2') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(16, 5, 'tinytable_css_idspsc23murum4ydahbui2') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(17, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(17, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(17, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(17, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(17, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(17, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(18, 0, 'tinytable_css_idy9p9ubrjqfhc7xc3so71') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(18, 1, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(18, 2, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(18, 3, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(18, 4, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
window.addEventListener('load', function () { styleCell_0hx9w03zyepfcsfa0qbj(18, 5, 'tinytable_css_id1hzt8wt7vkcsghjq0214') })
    </script>

    <style>
    .table td.tinytable_css_idtp94u943sexjcymiea7c, .table th.tinytable_css_idtp94u943sexjcymiea7c {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idvf2seixg50ifx5mcfcda, .table th.tinytable_css_idvf2seixg50ifx5mcfcda {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idy9p9ubrjqfhc7xc3so71, .table th.tinytable_css_idy9p9ubrjqfhc7xc3so71 {  text-align: left; }
    .table td.tinytable_css_id1hzt8wt7vkcsghjq0214, .table th.tinytable_css_id1hzt8wt7vkcsghjq0214 {  text-align: center; }
    .table td.tinytable_css_idbotk2t708w6r3k6af6tw, .table th.tinytable_css_idbotk2t708w6r3k6af6tw {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idspsc23murum4ydahbui2, .table th.tinytable_css_idspsc23murum4ydahbui2 {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_0hx9w03zyepfcsfa0qbj" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">2010 cohort</th>
                <th scope="col">2015 cohort</th>
                <th scope="col">No cohort FE</th>
                <th scope="col">Cohort FE</th>
                <th scope="col">Interactive</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)        </td>
                  <td>31.17    </td>
                  <td>26.68    </td>
                  <td>27.24    </td>
                  <td>25.99    </td>
                  <td>31.17    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.26)   </td>
                  <td>(0.23)   </td>
                  <td>(0.24)   </td>
                  <td>(0.57)   </td>
                  <td>(0.26)   </td>
                </tr>
                <tr>
                  <td>yearc              </td>
                  <td>1.96     </td>
                  <td>1.01     </td>
                  <td>1.10     </td>
                  <td>1.16     </td>
                  <td>1.96     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                  <td>(0.03)   </td>
                  <td>(0.04)   </td>
                  <td>(0.01)   </td>
                </tr>
                <tr>
                  <td>treat              </td>
                  <td>1.42     </td>
                  <td>4.14     </td>
                  <td>6.55     </td>
                  <td>5.96     </td>
                  <td>1.42     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.10)   </td>
                  <td>(0.07)   </td>
                  <td>(0.21)   </td>
                  <td>(0.19)   </td>
                  <td>(0.10)   </td>
                </tr>
                <tr>
                  <td>since              </td>
                  <td>1.04     </td>
                  <td>4.00     </td>
                  <td>2.05     </td>
                  <td>2.16     </td>
                  <td>1.04     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.02)   </td>
                  <td>(0.02)   </td>
                  <td>(0.13)   </td>
                  <td>(0.16)   </td>
                  <td>(0.02)   </td>
                </tr>
                <tr>
                  <td>cohort_2015        </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.23     </td>
                  <td>-4.49    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.38)   </td>
                  <td>(0.35)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × yearc</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>-0.96    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.01)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × treat</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.72     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.12)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × since</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.96     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.03)   </td>
                </tr>
                <tr>
                  <td>Num.Obs.           </td>
                  <td>6480     </td>
                  <td>13520    </td>
                  <td>20000    </td>
                  <td>20000    </td>
                  <td>20000    </td>
                </tr>
                <tr>
                  <td>Std.Errors         </td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Not surprisingly, since the cohort-specific models are basing the counterfactual off extrapolating from the <em>same</em> unit, the effects at the time of intervention and the post-intervention slopes are correct, but the intercept terms are now off because we have recentered year.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The pooled models with and without the cohort fixed effects give both the incorrect treatment effect and the incorrect slope. And, of course, the fully interactive model also gives identical estimates to what we found above.</p>
<p>Since we have recentered year we can’t really get an estimate of average predicted treatment effects at the end of follow-up. But we can get estimates for each cohort at the end of their respective follow-ups:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for 2010 cohort</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p_2010_c <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m_c2010_c, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">yearc =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">since =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>d_2010_c <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(p_2010_c, <span class="st">"b4 - b1 = 0"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>p_2010_c <span class="ot">&lt;-</span> p_2010_c <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rowid<span class="sc">==</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(d_2010_c) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"Untreated"</span>, <span class="st">"Treated"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Difference"</span>))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for 2015 cohort</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>p_2015_c <span class="ot">&lt;-</span> <span class="fu">predictions</span>(m_c2015_c, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">yearc =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">since =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>d_2015_c <span class="ot">&lt;-</span> <span class="fu">hypotheses</span>(p_2015_c, <span class="st">"b4 - b1 = 0"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>p_2015_c <span class="ot">&lt;-</span> p_2015_c <span class="sc">%&gt;%</span> </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(rowid<span class="sc">==</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(d_2015_c) <span class="sc">%&gt;%</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"Untreated"</span>, <span class="st">"Treated"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Difference"</span>))</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"2010 cohort (at 10yrs)"</span> <span class="ot">=</span> p_2010_c,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2015 cohort (at 5 yrs)"</span> <span class="ot">=</span> p_2015_c), <span class="at">fmt=</span><span class="dv">2</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="st">"conf.int"</span>, <span class="at">shape =</span> term <span class="sc">~</span> statistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_dngk9osw0gke24zkwjs8(i, j, css_id) {
        var table = document.getElementById("tinytable_dngk9osw0gke24zkwjs8");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_dngk9osw0gke24zkwjs8');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_dngk9osw0gke24zkwjs8(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_dngk9osw0gke24zkwjs8");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 0, 'tinytable_css_id8urwmco0s5ywdvvam3fq') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 1, 'tinytable_css_idk7bzxkzhxhljcy6rau8h') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 2, 'tinytable_css_idk7bzxkzhxhljcy6rau8h') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 3, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 4, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 5, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(0, 6, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 0, 'tinytable_css_idx1y01bfpao4i1q3tzvdz') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 1, 'tinytable_css_idq7rxf67hyrt17qe7xry9') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 2, 'tinytable_css_idq7rxf67hyrt17qe7xry9') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 3, 'tinytable_css_idq7rxf67hyrt17qe7xry9') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 4, 'tinytable_css_idq7rxf67hyrt17qe7xry9') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 5, 'tinytable_css_idq7rxf67hyrt17qe7xry9') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(1, 6, 'tinytable_css_idq7rxf67hyrt17qe7xry9') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 0, 'tinytable_css_id36num4w7wfm95lzje6e4') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 1, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 2, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 3, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 4, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 5, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(2, 6, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 0, 'tinytable_css_id36num4w7wfm95lzje6e4') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 1, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 2, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 3, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 4, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 5, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(3, 6, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 0, 'tinytable_css_id36num4w7wfm95lzje6e4') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 1, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 2, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 3, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 4, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 5, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
window.addEventListener('load', function () { styleCell_dngk9osw0gke24zkwjs8(4, 6, 'tinytable_css_idbc1a4hb8m9i8nxuier81') })
    </script>

    <style>
    .table td.tinytable_css_id8urwmco0s5ywdvvam3fq, .table th.tinytable_css_id8urwmco0s5ywdvvam3fq {  text-align: center;  text-align: left; }
    .table td.tinytable_css_idk7bzxkzhxhljcy6rau8h, .table th.tinytable_css_idk7bzxkzhxhljcy6rau8h {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_idbc1a4hb8m9i8nxuier81, .table th.tinytable_css_idbc1a4hb8m9i8nxuier81 {  text-align: center; }
    .table td.tinytable_css_idx1y01bfpao4i1q3tzvdz, .table th.tinytable_css_idx1y01bfpao4i1q3tzvdz {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idq7rxf67hyrt17qe7xry9, .table th.tinytable_css_idq7rxf67hyrt17qe7xry9 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id36num4w7wfm95lzje6e4, .table th.tinytable_css_id36num4w7wfm95lzje6e4 {  text-align: left; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_dngk9osw0gke24zkwjs8" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">2010 cohort (at 10yrs)</th>
<th scope="col" align="center" colspan="3">2015 cohort (at 5 yrs)</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Untreated </td>
                  <td>50.81</td>
                  <td>50.26</td>
                  <td>51.36</td>
                  <td>31.71</td>
                  <td>31.23</td>
                  <td>32.20</td>
                </tr>
                <tr>
                  <td>Treated   </td>
                  <td>62.66</td>
                  <td>62.18</td>
                  <td>63.14</td>
                  <td>55.86</td>
                  <td>55.43</td>
                  <td>56.28</td>
                </tr>
                <tr>
                  <td>Difference</td>
                  <td>11.85</td>
                  <td>11.49</td>
                  <td>12.21</td>
                  <td>24.14</td>
                  <td>23.95</td>
                  <td>24.33</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Exactly the same as we estimated using calendar time above. As we showed above, you can recover these same estimates using the fully interacted model, but the pooled models with and without the cohort fixed effect generate biased estimates of the true treatment effects.</p>
<p>Once again, the pooled models wildly overestimate the level shift and do not give the correct post-intervention slopes.</p>
<p>Okay, now let’s limit our comparisons to only the years where we have sufficient overlap of years once we center things (i.e., where <code>yearc</code> &gt;= -9 or &lt;= 5). Here is a plot of the restricted data:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="its-sim_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here are the models using relative time:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m_c2010_cr <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, cohort_2015<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>m_c2015_cr <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, cohort_2015<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>m_all_cr <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>m_all_s_cr <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">+</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>m_all_int_cr <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">*</span> (yearc <span class="sc">+</span> treat <span class="sc">+</span> since), </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds, yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"2010 cohort"</span> <span class="ot">=</span> m_c2010_cr,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2015 cohort"</span> <span class="ot">=</span> m_c2015_cr, <span class="st">"No cohort FE"</span> <span class="ot">=</span> m_all_cr,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cohort FE"</span> <span class="ot">=</span> m_all_s_cr, <span class="st">"Interactive"</span> <span class="ot">=</span> m_all_int_cr),</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_pi4jda4mqqrn1xphj8jw(i, j, css_id) {
        var table = document.getElementById("tinytable_pi4jda4mqqrn1xphj8jw");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_pi4jda4mqqrn1xphj8jw');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_pi4jda4mqqrn1xphj8jw(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_pi4jda4mqqrn1xphj8jw");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(0, 0, 'tinytable_css_id0bhb2l4ecquc5oiupoqd') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(0, 1, 'tinytable_css_id5l0u16zstpkn77qd0uct') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(0, 2, 'tinytable_css_id5l0u16zstpkn77qd0uct') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(0, 3, 'tinytable_css_id5l0u16zstpkn77qd0uct') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(0, 4, 'tinytable_css_id5l0u16zstpkn77qd0uct') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(0, 5, 'tinytable_css_id5l0u16zstpkn77qd0uct') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(1, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(1, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(1, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(1, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(1, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(1, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(2, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(2, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(2, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(2, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(2, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(2, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(3, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(3, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(3, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(3, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(3, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(3, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(4, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(4, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(4, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(4, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(4, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(4, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(5, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(5, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(5, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(5, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(5, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(5, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(6, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(6, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(6, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(6, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(6, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(6, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(7, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(7, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(7, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(7, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(7, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(7, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(8, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(8, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(8, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(8, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(8, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(8, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(9, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(9, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(9, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(9, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(9, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(9, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(10, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(10, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(10, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(10, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(10, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(10, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(11, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(11, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(11, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(11, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(11, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(11, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(12, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(12, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(12, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(12, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(12, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(12, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(13, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(13, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(13, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(13, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(13, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(13, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(14, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(14, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(14, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(14, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(14, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(14, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(15, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(15, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(15, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(15, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(15, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(15, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(16, 0, 'tinytable_css_idw1genblg8csmhg6n1qyv') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(16, 1, 'tinytable_css_id1pgclvo98eko59gkjkdv') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(16, 2, 'tinytable_css_id1pgclvo98eko59gkjkdv') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(16, 3, 'tinytable_css_id1pgclvo98eko59gkjkdv') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(16, 4, 'tinytable_css_id1pgclvo98eko59gkjkdv') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(16, 5, 'tinytable_css_id1pgclvo98eko59gkjkdv') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(17, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(17, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(17, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(17, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(17, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(17, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(18, 0, 'tinytable_css_idveefoivafcb07grmcnv3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(18, 1, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(18, 2, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(18, 3, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(18, 4, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
window.addEventListener('load', function () { styleCell_pi4jda4mqqrn1xphj8jw(18, 5, 'tinytable_css_idjmu5zeoevm3g5k5atkk3') })
    </script>

    <style>
    .table td.tinytable_css_id0bhb2l4ecquc5oiupoqd, .table th.tinytable_css_id0bhb2l4ecquc5oiupoqd {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id5l0u16zstpkn77qd0uct, .table th.tinytable_css_id5l0u16zstpkn77qd0uct {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idveefoivafcb07grmcnv3, .table th.tinytable_css_idveefoivafcb07grmcnv3 {  text-align: left; }
    .table td.tinytable_css_idjmu5zeoevm3g5k5atkk3, .table th.tinytable_css_idjmu5zeoevm3g5k5atkk3 {  text-align: center; }
    .table td.tinytable_css_idw1genblg8csmhg6n1qyv, .table th.tinytable_css_idw1genblg8csmhg6n1qyv {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id1pgclvo98eko59gkjkdv, .table th.tinytable_css_id1pgclvo98eko59gkjkdv {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_pi4jda4mqqrn1xphj8jw" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">2010 cohort</th>
                <th scope="col">2015 cohort</th>
                <th scope="col">No cohort FE</th>
                <th scope="col">Cohort FE</th>
                <th scope="col">Interactive</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)        </td>
                  <td>31.17    </td>
                  <td>27.08    </td>
                  <td>28.41    </td>
                  <td>27.44    </td>
                  <td>31.17    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.26)   </td>
                  <td>(0.24)   </td>
                  <td>(0.39)   </td>
                  <td>(0.54)   </td>
                  <td>(0.26)   </td>
                </tr>
                <tr>
                  <td>yearc              </td>
                  <td>1.96     </td>
                  <td>1.10     </td>
                  <td>1.38     </td>
                  <td>1.38     </td>
                  <td>1.96     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                  <td>(0.08)   </td>
                  <td>(0.08)   </td>
                  <td>(0.01)   </td>
                </tr>
                <tr>
                  <td>treat              </td>
                  <td>1.40     </td>
                  <td>3.74     </td>
                  <td>2.98     </td>
                  <td>2.98     </td>
                  <td>1.40     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.10)   </td>
                  <td>(0.07)   </td>
                  <td>(0.21)   </td>
                  <td>(0.21)   </td>
                  <td>(0.10)   </td>
                </tr>
                <tr>
                  <td>since              </td>
                  <td>1.05     </td>
                  <td>3.91     </td>
                  <td>2.98     </td>
                  <td>2.98     </td>
                  <td>1.05     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>(0.04)   </td>
                  <td>(0.02)   </td>
                  <td>(0.25)   </td>
                  <td>(0.25)   </td>
                  <td>(0.04)   </td>
                </tr>
                <tr>
                  <td>cohort_2015        </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>1.43     </td>
                  <td>-4.09    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.35)   </td>
                  <td>(0.35)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × yearc</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>-0.87    </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.02)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × treat</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.34     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.12)   </td>
                </tr>
                <tr>
                  <td>cohort_2015 × since</td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>2.86     </td>
                </tr>
                <tr>
                  <td>                   </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>         </td>
                  <td>(0.04)   </td>
                </tr>
                <tr>
                  <td>Num.Obs.           </td>
                  <td>4860     </td>
                  <td>10140    </td>
                  <td>15000    </td>
                  <td>15000    </td>
                  <td>15000    </td>
                </tr>
                <tr>
                  <td>Std.Errors         </td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>These estimates look good. The estimated level shifts and the post-intervention slopes are just about identical to what we got using calendar time. It’s also interesting to see that the level and slope parameters from the pooled models with and without cohort fixed effects also give correct average level and slope parameters, which is in contrast to the calendar time models above. This is because recentering year and limiting the data to overlapping periods removes the extrapolation and positivity violations that were created using calendar time and ignoring heterogeneity by cohort.</p>
<p>As the model comparison shows, including just the cohort fixed effect here only allows for a ‘level shift’, so it has no impact on the estimated treatment effect at the time of intervention (<code>treat</code>) or the post-intervention slope (<code>since</code>). So these models will both produce the same average slopes (though not exactly the same average predictions because of the cohort fixed effect).</p>
<p>The average post-intervention slope for the model with cohort is 2.98 (same for the model with cohort), and both of these estimates are nearly the same as the estimate we calculated as a weighted average for the full sample using calendar time, which was 3.02.</p>
<p>With the fully interacted model using restricted relative time, you get the same slope parameters for <code>treat</code>, <code>since</code> and their interactions with cohort, but the level parameters (e.g., intercept, cohort fixed effect) will be different. You can then back out predictions for a fixed time post-intervention (e.g., 10 years), but this will obviously lead to extrapolation for the later treated cohort. Nevertheless this shows that the relative time model after eliminating overlap <em>can</em> recover estimates of the true treatment effects.</p>
</section>
<section id="hang-on" class="level2">
<h2 class="anchored" data-anchor-id="hang-on">Hang on…</h2>
<p>The big caveat to the last point above is that this only occurs under specific kinds of scenarios. In particular, the restricted, centered time approach ‘works’ in recovering the true slopes in our prior example because the simulated trends are linear (though not identical across cohorts) in both of the pre- and post-treatment periods. It’s intuitive in the sense that, if the trends are linear through the entire time, it shouldn’t matter much whether you use 10 pre-periods or 5 pre-periods to estimate the pre-intervention slope (and vice versa for the post-intervention slope in the early treated cohort).</p>
<p>But this is a strong (and unnecessary) assumption, artificially reduces the sample size and restricts the population for making inferences, and does not allow for the same kinds of treatment effect estimation as when using calendar time.</p>
<p>Plus, if there is non-linearity in the slopes then restricting the analysis to periods of overlap won’t actually help to recover the ‘true’ effects. Let’s slightly modify our example. We will keep the treatment effects identical to the last example but now introduce a small amount of non-linearity to the pre-intervention trends for the 2015 cohort.</p>
<p>Here is the code to tweak our previous simulation:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ds2 <span class="ot">&lt;-</span> ds <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add non-linearity to early part of 2015 cohort</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_fe =</span> <span class="fu">ifelse</span>(cohort_year<span class="sc">==</span><span class="dv">2015</span> <span class="sc">&amp;</span> year<span class="sc">&lt;</span><span class="dv">2006</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>          year_fe <span class="sc">+</span> (<span class="dv">2015</span> <span class="sc">-</span> cohort_year) <span class="sc">*</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>           (year <span class="sc">-</span> cohort_year) <span class="sc">/</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">12</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>          year_fe <span class="sc">+</span> (<span class="dv">2020</span> <span class="sc">-</span> cohort_year) <span class="sc">*</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>           (year <span class="sc">-</span> cohort_year) <span class="sc">/</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">20</span>), </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># re-generate outcome</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> (<span class="dv">2020</span> <span class="sc">-</span> cohort_year) <span class="sc">+</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>           unit_fe <span class="sc">+</span> year_fe <span class="sc">+</span> tau_cum <span class="sc">+</span> error) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is our new plot:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ds2 <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year0, <span class="at">y =</span> y, <span class="at">group =</span> unit)) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cohort_year, year0) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">y =</span> <span class="fu">mean</span>(y)),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">aes</span>(<span class="at">x =</span> year0, <span class="at">y =</span> y, <span class="at">group =</span> <span class="fu">factor</span>(cohort_year),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">factor</span>(cohort_year)), <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year0) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">y =</span> <span class="fu">mean</span>(y)),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> year0, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">"#4daf4a"</span>, <span class="at">group=</span><span class="st">"All"</span>), </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Y"</span>,  <span class="at">color =</span> <span class="st">"Treatment group   "</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">'#E41A1C'</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">'#377EB8'</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">'Set1'</span>, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"2010"</span>, <span class="st">"2015"</span>, <span class="st">"Average"</span>)) <span class="sc">+</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="its-sim_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this particular scenario, the non-linear part of the trend for the 2015 cohort is in the very early pre-period (everything else is the same), which means it won’t be captured when we have to restrict to years of overlap when using relative time. Here is a plot using relative time:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ds2 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> yearc, <span class="at">y =</span> y, <span class="at">group =</span> unit)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cohort_year, yearc) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">y =</span> <span class="fu">mean</span>(y)),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">aes</span>(<span class="at">x =</span> yearc, <span class="at">y =</span> y, <span class="at">group =</span> <span class="fu">factor</span>(cohort_year),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">factor</span>(cohort_year)), <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ds2 <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(yearc) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">y =</span> <span class="fu">mean</span>(y)),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> yearc, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">"#4daf4a"</span>, <span class="at">group=</span><span class="st">"All"</span>), </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Y"</span>,  <span class="at">color =</span> <span class="st">"Treatment group   "</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">'#984ea3'</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">'Set1'</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"2010"</span>, <span class="st">"2015"</span>, <span class="st">"Average"</span>)) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="its-sim_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This looks a lot like the plot from our original simulation. We won’t go through all of the prior models, but let’s compare what we get from the interactive analysis using calendar time, as well as the simple model using restricted time, which we saw gave us the correct slope in the example above. Here are the models and parameters:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calendar time full model</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>m_all_int2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">*</span> (year0 <span class="sc">+</span> treat <span class="sc">+</span> since),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ds2, <span class="at">clusters =</span> state)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># relative time full model</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>m_all_int_cr2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">*</span> (yearc <span class="sc">+</span> treat <span class="sc">+</span> since), </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(ds2, yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"Sim1: Interaction"</span> <span class="ot">=</span> m_all_int, </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sim2: Interaction"</span> <span class="ot">=</span> m_all_int2,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sim1: Interaction"</span> <span class="ot">=</span> m_all_int_cr, </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sim2: Interaction"</span> <span class="ot">=</span> m_all_int_cr2),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">coef_rename =</span> <span class="fu">c</span>(<span class="st">"year0"</span> <span class="ot">=</span> <span class="st">"year"</span>, </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"yearc"</span> <span class="ot">=</span> <span class="st">"year"</span>),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">'tinytable'</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">tt</span>(ft<span class="sc">@</span>table_dataframe) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j=</span><span class="fu">list</span>(<span class="st">"Calendar time"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Relative time (restricted)"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_5npgxyb7yz4ldm5aiomx(i, j, css_id) {
        var table = document.getElementById("tinytable_5npgxyb7yz4ldm5aiomx");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_5npgxyb7yz4ldm5aiomx');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_5npgxyb7yz4ldm5aiomx(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_5npgxyb7yz4ldm5aiomx");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(0, 0, 'tinytable_css_idnon93vyeo2vlzjsb6m9b') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(0, 1, 'tinytable_css_id5dfccio95lail2z0by8b') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(0, 2, 'tinytable_css_id5dfccio95lail2z0by8b') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(0, 3, 'tinytable_css_idnon93vyeo2vlzjsb6m9b') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(0, 4, 'tinytable_css_idnon93vyeo2vlzjsb6m9b') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(1, 0, 'tinytable_css_idu5ajfsuhibk4fy3x4qie') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(1, 1, 'tinytable_css_idu5ajfsuhibk4fy3x4qie') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(1, 2, 'tinytable_css_idu5ajfsuhibk4fy3x4qie') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(1, 3, 'tinytable_css_idu5ajfsuhibk4fy3x4qie') })
window.addEventListener('load', function () { styleCell_5npgxyb7yz4ldm5aiomx(1, 4, 'tinytable_css_idu5ajfsuhibk4fy3x4qie') })
    </script>

    <style>
    .table td.tinytable_css_idnon93vyeo2vlzjsb6m9b, .table th.tinytable_css_idnon93vyeo2vlzjsb6m9b {  text-align: center; }
    .table td.tinytable_css_id5dfccio95lail2z0by8b, .table th.tinytable_css_id5dfccio95lail2z0by8b {  border-bottom: solid 0.05em #d3d8dc;  text-align: center; }
    .table td.tinytable_css_idu5ajfsuhibk4fy3x4qie, .table th.tinytable_css_idu5ajfsuhibk4fy3x4qie {  border-bottom: solid 0.1em #d3d8dc; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_5npgxyb7yz4ldm5aiomx" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="2">Calendar time</th>
<th scope="col" align="center" colspan="2">Relative time (restricted)</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Sim1: Interaction</th>
                <th scope="col">Sim2: Interaction</th>
                <th scope="col">Sim1: Interaction </th>
                <th scope="col">Sim2: Interaction </th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)      </td>
                  <td>13.49    </td>
                  <td>15.49    </td>
                  <td>31.17    </td>
                  <td>51.17    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.28)   </td>
                  <td>(0.28)   </td>
                  <td>(0.26)   </td>
                  <td>(0.26)   </td>
                </tr>
                <tr>
                  <td>cohort_2015      </td>
                  <td>-0.90    </td>
                  <td>7.39     </td>
                  <td>-4.09    </td>
                  <td>-4.09    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.35)   </td>
                  <td>(0.35)   </td>
                  <td>(0.35)   </td>
                  <td>(0.35)   </td>
                </tr>
                <tr>
                  <td>year             </td>
                  <td>1.96     </td>
                  <td>3.96     </td>
                  <td>1.96     </td>
                  <td>3.96     </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                </tr>
                <tr>
                  <td>treat            </td>
                  <td>1.42     </td>
                  <td>1.42     </td>
                  <td>1.40     </td>
                  <td>1.40     </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.10)   </td>
                  <td>(0.10)   </td>
                  <td>(0.10)   </td>
                  <td>(0.10)   </td>
                </tr>
                <tr>
                  <td>since            </td>
                  <td>1.04     </td>
                  <td>1.04     </td>
                  <td>1.05     </td>
                  <td>1.05     </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.02)   </td>
                  <td>(0.02)   </td>
                  <td>(0.04)   </td>
                  <td>(0.04)   </td>
                </tr>
                <tr>
                  <td>cohort_2015:year </td>
                  <td>-0.96    </td>
                  <td>-2.40    </td>
                  <td>-0.87    </td>
                  <td>-1.87    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.01)   </td>
                  <td>(0.01)   </td>
                  <td>(0.02)   </td>
                  <td>(0.02)   </td>
                </tr>
                <tr>
                  <td>cohort_2015:treat</td>
                  <td>2.72     </td>
                  <td>4.59     </td>
                  <td>2.34     </td>
                  <td>2.34     </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.12)   </td>
                  <td>(0.12)   </td>
                  <td>(0.12)   </td>
                  <td>(0.12)   </td>
                </tr>
                <tr>
                  <td>cohort_2015:since</td>
                  <td>2.96     </td>
                  <td>3.40     </td>
                  <td>2.86     </td>
                  <td>2.86     </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.03)   </td>
                  <td>(0.03)   </td>
                  <td>(0.04)   </td>
                  <td>(0.04)   </td>
                </tr>
                <tr>
                  <td>Num.Obs.         </td>
                  <td>20000    </td>
                  <td>20000    </td>
                  <td>15000    </td>
                  <td>15000    </td>
                </tr>
                <tr>
                  <td>Std.Errors       </td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                  <td>by: state</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Since we only intervened with the pre-trend for the 2015 cohort, the <code>treat</code> and <code>since</code> values are identical in the interacted model using calendar time, since these are the treatment effects for the 2010 cohort. However, the <code>treat</code> effect for the 2015 cohort (i.e., <span class="math inline">\(\beta*treat + \beta*cohort_{2015}*treat\)</span>) is now 6 instead of 4.14 and the post-intervention slope effect (<code>since</code>, i.e., <span class="math inline">\(\beta*since + \beta*cohort_{2015}*since\)</span>) is now 4.44 instead of 4.</p>
<p>These differences in the true effects are due to the fact that introducing this bit of non-linearity in the early years flattens the pre-intervention slope for the 2015 cohort, leading to a larger jump at the intervention and greater slope in the post-intervention period.</p>
<p>Above we saw that when using relative time and limiting the data to years of overlap even the simple models with or without a fixed effect for cohort could recover the weighted average treatment slope from the calendar time model. What do we get now?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># relative time basic model</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>m_all_cr2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(ds2, yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># relative time cohort FE model</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>m_all_s_cr2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> cohort_2015 <span class="sc">+</span> yearc <span class="sc">+</span> treat <span class="sc">+</span> since,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(ds2, yearc <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">&amp;</span> yearc <span class="sc">&lt;=</span> <span class="dv">5</span>), </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">clusters =</span> state)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"No cohort FE"</span> <span class="ot">=</span> m_all_cr2,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cohort FE"</span> <span class="ot">=</span> m_all_s_cr2),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="at">statistic =</span> <span class="st">"conf.int"</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> term <span class="sc">~</span> model <span class="sc">+</span> statistic,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">'DF|Deviance|R2|AIC|BIC|RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_8a9uym01up5z4og6pt8b(i, j, css_id) {
        var table = document.getElementById("tinytable_8a9uym01up5z4og6pt8b");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_8a9uym01up5z4og6pt8b');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_8a9uym01up5z4og6pt8b(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_8a9uym01up5z4og6pt8b");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 0, 'tinytable_css_idy22ndeklsrg7ull2dr3j') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 1, 'tinytable_css_id0njnawbrm6f8as5y08wk') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 2, 'tinytable_css_id0njnawbrm6f8as5y08wk') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(0, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 0, 'tinytable_css_id31yqmtaueedhdrunoyhn') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 1, 'tinytable_css_idl0jkc2cpp5i9zn5zr3qy') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 2, 'tinytable_css_idl0jkc2cpp5i9zn5zr3qy') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 3, 'tinytable_css_idl0jkc2cpp5i9zn5zr3qy') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 4, 'tinytable_css_idl0jkc2cpp5i9zn5zr3qy') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 5, 'tinytable_css_idl0jkc2cpp5i9zn5zr3qy') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(1, 6, 'tinytable_css_idl0jkc2cpp5i9zn5zr3qy') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 0, 'tinytable_css_idr0q0xcqr7w3fgtzfg67e') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 1, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 2, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(2, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 0, 'tinytable_css_idr0q0xcqr7w3fgtzfg67e') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 1, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 2, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(3, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 0, 'tinytable_css_idr0q0xcqr7w3fgtzfg67e') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 1, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 2, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(4, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 0, 'tinytable_css_idr0q0xcqr7w3fgtzfg67e') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 1, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 2, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(5, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 0, 'tinytable_css_id5wi6t0jup6o5mykqw5ky') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 1, 'tinytable_css_idluzivgd1j448uzwomy2q') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 2, 'tinytable_css_idluzivgd1j448uzwomy2q') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 3, 'tinytable_css_idluzivgd1j448uzwomy2q') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 4, 'tinytable_css_idluzivgd1j448uzwomy2q') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 5, 'tinytable_css_idluzivgd1j448uzwomy2q') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(6, 6, 'tinytable_css_idluzivgd1j448uzwomy2q') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 0, 'tinytable_css_idr0q0xcqr7w3fgtzfg67e') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 1, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 2, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(7, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 0, 'tinytable_css_idr0q0xcqr7w3fgtzfg67e') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 1, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 2, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 3, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 4, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 5, 'tinytable_css_id5lykw77cima94f8uhtdb') })
window.addEventListener('load', function () { styleCell_8a9uym01up5z4og6pt8b(8, 6, 'tinytable_css_id5lykw77cima94f8uhtdb') })
    </script>

    <style>
    .table td.tinytable_css_idy22ndeklsrg7ull2dr3j, .table th.tinytable_css_idy22ndeklsrg7ull2dr3j {  text-align: center;  text-align: left; }
    .table td.tinytable_css_id0njnawbrm6f8as5y08wk, .table th.tinytable_css_id0njnawbrm6f8as5y08wk {  text-align: center;  border-bottom: solid 0.05em #d3d8dc; }
    .table td.tinytable_css_id5lykw77cima94f8uhtdb, .table th.tinytable_css_id5lykw77cima94f8uhtdb {  text-align: center; }
    .table td.tinytable_css_id31yqmtaueedhdrunoyhn, .table th.tinytable_css_id31yqmtaueedhdrunoyhn {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idl0jkc2cpp5i9zn5zr3qy, .table th.tinytable_css_idl0jkc2cpp5i9zn5zr3qy {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idr0q0xcqr7w3fgtzfg67e, .table th.tinytable_css_idr0q0xcqr7w3fgtzfg67e {  text-align: left; }
    .table td.tinytable_css_id5wi6t0jup6o5mykqw5ky, .table th.tinytable_css_id5wi6t0jup6o5mykqw5ky {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idluzivgd1j448uzwomy2q, .table th.tinytable_css_idluzivgd1j448uzwomy2q {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_8a9uym01up5z4og6pt8b" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">No cohort FE</th>
<th scope="col" align="center" colspan="3">Cohort FE</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>48.41    </td>
                  <td>47.65</td>
                  <td>49.17</td>
                  <td>46.08    </td>
                  <td>44.72</td>
                  <td>47.45</td>
                </tr>
                <tr>
                  <td>yearc      </td>
                  <td>2.70     </td>
                  <td>2.38 </td>
                  <td>3.02 </td>
                  <td>2.70     </td>
                  <td>2.38 </td>
                  <td>3.02 </td>
                </tr>
                <tr>
                  <td>treat      </td>
                  <td>2.98     </td>
                  <td>2.56 </td>
                  <td>3.40 </td>
                  <td>2.98     </td>
                  <td>2.56 </td>
                  <td>3.40 </td>
                </tr>
                <tr>
                  <td>since      </td>
                  <td>2.98     </td>
                  <td>2.49 </td>
                  <td>3.47 </td>
                  <td>2.98     </td>
                  <td>2.49 </td>
                  <td>3.47 </td>
                </tr>
                <tr>
                  <td>cohort_2015</td>
                  <td>         </td>
                  <td>     </td>
                  <td>     </td>
                  <td>3.43     </td>
                  <td>2.76 </td>
                  <td>4.11 </td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>15000    </td>
                  <td>     </td>
                  <td>     </td>
                  <td>15000    </td>
                  <td>     </td>
                  <td>     </td>
                </tr>
                <tr>
                  <td>Std.Errors </td>
                  <td>by: state</td>
                  <td>     </td>
                  <td>     </td>
                  <td>by: state</td>
                  <td>     </td>
                  <td>     </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>From the interacted calendar time models above the true weighed average <code>treat</code> effect is 3.53 and the weighted average <code>since</code> effect is 2.61. The estimates using the restricted relative time models with and without cohort fixed effects are identical: 2.98 for <code>treat</code> and 2.98 for <code>since</code>. These aren’t accurate estimates. This is precisely because the pre-intervention slope of the restricted relative time model does not account for the diminished slope of the 2015 cohort in the early pre-period.</p>
<p>Even the interacted model using restricted relative time that allows for separate treatment effects by cohort does not recover the true treatment effects. Those (weighted average) estimates are 2.02 for level effect and 2.26 for the post-intervention slope effect. Again, the main issue is the fact that the average pre-intervention slope for the 2015 cohort is biased downward. Obviously this latter simulation does not introduce a lot of non-linearity in the pre-trends, but even a small amount leads to bias when using relative time and restricting to common years of overlap.</p>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Note this model is set up for an ITS where the product term uses the ‘time-since intervention’, i.e.&nbsp;<code>since</code> term. This is calculated as year0 - year0 at time of intervention<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In fact, you’ll note that the estimated intercepts for these models are exactly the predicted outcomes for the non-centered models at the time of the intervention.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>